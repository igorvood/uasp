# Описание архитектуры микро сервисов универсальной аналитической стриминговой платформы



## Базовые правила разработки streaming-сервисов

- [ ] Каждый входящий поток должен иметь исходящий поток со статусом обработки или результатом обработки для осуществления в дальнейшем анализа и упрощения механизма тестирования
- [ ] Внутренние взаимодействие микро сервисов осуществляется с использованием avro-объекта доставки данных UaspDto (dto - data transfer оbject) 
- [ ] В случае интеграции с внешними системами с входящим потоком отличным от UaspDto всегда создаётся streaming-сервис адаптер преобразующий входящий поток сообщений в avro-объект UaspDto
- [ ] Для входящего потока всегда используется ключ того домена для которого выполняться вычисления
- [ ] В случае отсутствия ключа домена необходимого для вычислений поток после streaming-сервиса адаптера перенаправляется в streaming-сервис обогащения после которого исходящие сообщения UaspDto всегда с ключом того домена относительно которого выполняются вычисления
- [ ] Сообщение должны быть приведенны к атомарным объектом с информацией только по одному домену, иначе необходимо выполнить расщипление (split) сообщений на атомарные




## Avro-объект UaspDto

Для передачи данных между микро сервисами универсальной аналитической стриминговой платформы используется avro-объект UaspDto который преобразуется в  [case class UaspDto](https://bitbucket.region.vtb.ru/projects/DRPIM/repos/uasp-streaming-common/browse/src/main/scala/ru/vtb/uasp/common/dto/UaspDto.scala?at=refs%2Fheads%2Fmain)

 [Схема avro-объекта UaspDto](https://bitbucket.region.vtb.ru/projects/DRPIM/repos/uasp-streaming-common/browse/src/main/resources/avro/schemas/UaspDto.json?at=refs%2Fheads%2Fmain)







